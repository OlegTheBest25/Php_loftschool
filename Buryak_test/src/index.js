import treeArr from "./treeArr.js";
import createElement from "./createElement.js";

const res = {
  services: [
    {
      id: 1,
      head: null,
      name: "Проф.осмотр",
      node: 0,
      price: 100.0,
      sorthead: 20,
    },
    {
      id: 2,
      head: null,
      name: "Хирургия",
      node: 1,
      price: 0.0,
      sorthead: 10,
    },
    {
      id: 3,
      head: 2,
      name: "Удаление зубов",
      node: 1,
      price: 0.0,
      sorthead: 10,
    },
    {
      id: 4,
      head: 3,
      name: "Удаление зуба",
      node: 0,
      price: 800.0,
      sorthead: 10,
    },
    {
      id: 5,
      head: 3,
      name: "Удаление 8ого зуба",
      node: 0,
      price: 1000.0,
      sorthead: 30,
    },
    {
      id: 6,
      head: 3,
      name: "Удаление осколка зуба",
      node: 0,
      price: 2000.0,
      sorthead: 20,
    },
    {
      id: 7,
      head: 2,
      name: "Хирургические вмешательство",
      node: 0,
      price: 200.0,
      sorthead: 10,
    },
    {
      id: 8,
      head: 2,
      name: "Имплантация зубов",
      node: 1,
      price: 0.0,
      sorthead: 20,
    },
    {
      id: 9,
      head: 8,
      name: "Коронка",
      node: 0,
      price: 3000.0,
      sorthead: 10,
    },
    {
      id: 10,
      head: 8,
      name: "Слепок челюсти",
      node: 0,
      price: 500.0,
      sorthead: 20,
    },
  ],
};

const Root = document.getElementById("root");

let ulRoot = document.createElement("ul");

let n = 0; /* Уровень вложенности*/

/* Функция Tree возвращает дерево n-ой вложенности*/
let Tree = treeArr(res.services);

function createDom(arr) {
  arr.sort(function (a, b) {
    return a.sorthead - b.sorthead;
  });
  for (let elem of arr) {
    let li = createElement(elem);
    li.style.marginLeft = `${n}px`;
    ulRoot.append(li);
    if (elem.node == 1) {
      n = n + 50;
      createDom(elem.children);
      n = n - 50;
    }
  }

  return ulRoot;
}

Root.append(createDom(Tree));
console.log(Tree);
